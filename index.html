<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Challenging Platformer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { margin: 0; background: #111; display: flex; justify-content: center; align-items: center; height: 100vh; }
  canvas { background: #222; display: block; }
  #timer { position: absolute; top: 10px; left: 10px; color: white; font-family: sans-serif; font-size: 24px; }
</style>
</head>
<body>
<div id="timer">Time: 0s</div>
<canvas id="game" width="800" height="400"></canvas>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

// Player
const player = { x: 50, y: 330, w: 30, h: 50, vx: 0, vy: 0, speed: 4, jump: -12, onGround: false };

// Level
const platforms = [
  {x:0,y:380,w:800,h:20},
  {x:150,y:300,w:100,h:20},
  {x:300,y:250,w:100,h:20},
  {x:450,y:200,w:100,h:20},
  {x:600,y:150,w:100,h:20}
];

const spikes = [
  {x:200,y:365,w:50,h:15},
  {x:350,y:235,w:50,h:15},
  {x:500,y:185,w:50,h:15}
];

const goal = {x:700, y:100, w:50, h:50};

let keys = {};
let time = 0;
let gameOver = false;

// Controls
document.addEventListener('keydown', e => keys[e.key] = true);
document.addEventListener('keyup', e => keys[e.key] = false);

// Game loop
function update() {
  if (gameOver) return;

  // Timer
  time += 1/60;
  document.getElementById('timer').textContent = "Time: " + time.toFixed(1) + "s";

  // Horizontal movement
  player.vx = 0;
  if (keys['ArrowLeft'] || keys['a']) player.vx = -player.speed;
  if (keys['ArrowRight'] || keys['d']) player.vx = player.speed;

  // Gravity
  player.vy += 0.5;
  player.x += player.vx;
  player.y += player.vy;

  // Collisions with platforms
  player.onGround = false;
  for (let p of platforms) {
    if (player.x + player.w > p.x && player.x < p.x + p.w &&
        player.y + player.h > p.y && player.y + player.h < p.y + p.h + player.vy) {
      player.y = p.y - player.h;
      player.vy = 0;
      player.onGround = true;
    }
  }

  // Jump
  if ((keys['ArrowUp'] || keys['w'] || keys[' ']) && player.onGround) {
    player.vy = player.jump;
    player.onGround = false;
  }

  // Check spikes
  for (let s of spikes) {
    if (player.x + player.w > s.x && player.x < s.x + s.w &&
        player.y + player.h > s.y && player.y < s.y + s.h) {
      gameOver = true;
      alert("You hit spikes! Game Over.");
      location.reload();
    }
  }

  // Check goal
  if (player.x + player.w > goal.x && player.x < goal.x + goal.w &&
      player.y + player.h > goal.y && player.y < goal.y + goal.h) {
    gameOver = true;
    alert("You reached the goal in " + time.toFixed(1) + " seconds!");
    location.reload();
  }

  // Boundaries
  if (player.y > canvas.height) {
    gameOver = true;
    alert("You fell! Game Over.");
    location.reload();
  }

  draw();
  requestAnimationFrame(update);
}

function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Platforms
  ctx.fillStyle = '#888';
  for (let p of platforms) ctx.fillRect(p.x,p.y,p.w,p.h);

  // Spikes
  ctx.fillStyle = 'red';
  for (let s of spikes) ctx.beginPath(), ctx.moveTo(s.x,s.y+s.h), ctx.lineTo(s.x+s.w/2,s.y), ctx.lineTo(s.x+s.w,s.y+s.h), ctx.fill();

  // Goal
  ctx.fillStyle = 'gold';
  ctx.fillRect(goal.x, goal.y, goal.w, goal.h);

  // Player
  ctx.fillStyle = 'cyan';
  ctx.fillRect(player.x, player.y, player.w, player.h);
}

update();
</script>
</body>
</html>
